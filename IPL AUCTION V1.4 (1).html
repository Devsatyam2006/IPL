<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPL AUCTION ANALYZER V1.4</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/1f66b98cb1.js" crossorigin="anonymous"></script>
</head>
<style>
    * {
        margin: 0px;
        padding: 0px;
        box-sizing: border-box;
    }

    body::-webkit-scrollbar {
        display: none;
    }

    body::-webkit-scrollbar {
        display: none;
    }

    ::-webkit-scrollbar {
        width: 5px;
    }

    ::-webkit-scrollbar-track {
        background: white;
    }

    ::-webkit-scrollbar-thumb {
        background: #19388A;
    }

    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }

    .one {
        height: 20vh;
        width: 100%;
        background-color: #19388A;
        display: flex;
        justify-content: space-between;
        align-items: center;
        overflow: hidden;
    }

    .two {
        height: 80vh;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: white;
    }

    .three {
        height: 10vh;
        width: 100%;
    }

    .header {
        height: 100%;
        width: 100%;
        display: flex;
        justify-content: space-between;
        /* Adjust layout */
        align-items: center;
        border: 1px solid #19388A;
    }

    .purse,
    .rating {
        height: 100%;
        width: 40%;
        background-color: #19388A;
        display: flex;
        justify-content: flex-end;
        padding-right: 20px;
        align-items: center;
        border: 1px solid #19388A;
    }

    .rating {
        justify-content: flex-start;
        padding-left: 20px;
    }

    .create {
        height: 100%;
        width: 20%;
        border: 1px solid transparent;
        background-color: #19388A;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
    }

    .highest-stats {
        width: 70%;
        height: 50%;
        color: white;
        background-color: #4F91CD;
        border-radius: 5px;
        font-size: 110%;
        display: flex;
        justify-content: center;
        align-items: center;
        border: 1px solid transparent;
    }

    .teambox {
        height: 95%;
        width: 90%;
        overflow-y: hidden;
        overflow-x: auto;
        display: flex;
        justify-content: flex-start;
        align-items: center;
        overflow-x: scroll;
        border: 1px solid transparent;

    }

    #inner2 {
        height: 98%;
        display: flex;
        gap: 15px;
        border: 2px solid transparent;
        justify-content: flex-start;
        align-items: center;
        padding: 10px;
    }


    .team {
        border: 1px solid black;
        border-radius: 5px;
        background-color: #ffffff;
        width: 370px;
        height: 100%;
        overflow-y: scroll;
        padding: 20px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .team::-webkit-scrollbar {
        display: none;
    }
    
    .team .teamone {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border: 1px solid transparent;
        margin-bottom: 15px;
    }
        .team .teamlogo {
        border-radius: 50%;
        display: flex;
        justify-content: center;
        align-items: center;
        width: 40%;
    }
    .team .teamlogo img {
        width: 135px;
        height: auto;
        padding: 12px;
        transition: box-shadow 0.3s, transform 0.3s;
    }
    .team .teamdetail {
        border: 1px solid transparent;
        font-weight: bold;
        text-align: left;
        width: 60%;
        padding-left: 10px;
    }

    .team .teamtwo {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 10px;
        border-radius: 5px;
        color: black;
        font-weight: bold;
        margin-bottom: 10px;
    }
.team .teamthree {
    overflow-y: auto;
    border-radius: 10px;
    background-color: #ffffff;
    padding: 10px;
    max-height: 200px;
    box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);
}

.foottext {
    display: flex;
    justify-content: center;
    align-items: center;
}

.team .teamthree table {
    width: 100%;
    border-collapse: collapse;
}

.team .teamthree th,
.team .teamthree td {
    text-align: center;
    padding: 10px;
    font-size: 0.9rem;
    font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    word-wrap: break-word;
}

.team .teamthree th {
    font-size: small;
    text-transform: uppercase;
}

.team .teamthree td {
    white-space: nowrap;
    overflow-x: scroll;
    max-width: 85px; /* Adjusted max-width for better fit */
}

   .team .teamthree td {
        max-width: 150px;
        overflow-x: scroll;
    }

    .team .teamthree td::-webkit-scrollbar {
        height: 8px;
    }

    .team .teamthree td::-webkit-scrollbar-thumb {
        background-color: #888;
        border-radius: 10px;
    }

    /* Scrollbar customization */
    .team .teamthree::-webkit-scrollbar {
        display: none;
    }

    .team .teamthree td::-webkit-scrollbar {
        display: none;
    }
.team .teamthree tr:nth-child(even) {
    background-color: #F9F9F9;
}

.team .teamthree tr:nth-child(odd) {
    background-color: white;
}

tr.dragging {
    background-color: #f0f0f0; /* Highlight dragging row */
}

/* Custom background colors for specific teams */
.team:nth-child(1) .teamthree tr:nth-child(even) {
    background-color: #FDFD96;
}

.team:nth-child(2) .teamthree tr:nth-child(even) {
    background-color: #C1E1C1;
}

.team:nth-child(3) .teamthree tr:nth-child(even) {
    background-color: #A2BFFE;
}

.team:nth-child(4) .teamthree tr:nth-child(even) {
    background-color: #FDE0E0;
}

.team:nth-child(5) .teamthree tr:nth-child(even) {
    background-color: #966FD6;
}

.team:nth-child(6) .teamthree tr:nth-child(even) {
    background-color: #FDFD96;
}

.team:nth-child(7) .teamthree tr:nth-child(even) {
    background-color: #C1E1C1;
}

.team:nth-child(8) .teamthree tr:nth-child(even) {
    background-color: #A2BFFE;
}

.team:nth-child(9) .teamthree tr:nth-child(even) {
    background-color: #FDE0E0;
}

.team:nth-child(10) .teamthree tr:nth-child(even) {
    background-color: #966FD6;
}

footer {
        background-color: #19388A;
        color: white;
        width: 100%;
    }




    @media (max-width: 800px) {
        *::-webkit-scrollbar {
            display: none;
        }

        .one {
            height: 25vh;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;

        }

        .two {
            height: 75vh;
            width: 100%;
        }

        .three {
            height: 5vh;
            width: 100%;
            background-color: #19388A;
        }

        .header {
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            border: 1px solid transparent;
        }

        .purse,
        .rating {
            height: 35%;
            width: 100%;
            background-color: #19388A;
            border: 1px solid #19388A;
            padding: 0px;
            justify-content: center;
        }


        .create {
            height: 30%;
            width: 100%;
            border: 1px solid transparent;
            background-color: #19388A;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
        }

        .highest-stats {
            height: 60%;
            width: 70%;
            border-radius: 5px;
            font-size: 80%;
            border: 1px solid transparent;
        }

        .teambox {
            width: 90%;
        }


    }

    @media (min-width: 801px) and (max-width: 1024px) {
        * {
            margin: 0px;
            padding: 0px;
            box-sizing: border-box;
        }

        body::-webkit-scrollbar {
            display: none;
        }

        .one {
            height: 20vh;
            width: 100%;
            justify-content: space-between;
            align-items: center;
            overflow: hidden;
        }

        .two {
            height: 80vh;
            width: 100%;
        }

        .three {
            height: 5vh;
            width: 100%;
        }

        .header {
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #19388A;
        }

        .purse,
        .rating {
            height: 100%;
            width: 40%;
            background-color: #19388A;
            display: flex;
            justify-content: flex-end;
            padding-right: 20px;
            align-items: center;
            border: 1px solid #19388A;
        }

        .rating {
            justify-content: flex-start;
            padding-left: 20px;
        }

        .create {
            height: 100%;
            width: 20%;
            border: 1px solid transparent;
            background-color: #19388A;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .highest-stats {
            width: 85%;
            height: 35%;
            color: white;
            background-color: #4F91CD;
            border-radius: 5px;
            font-size: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid transparent;
        }


    }

    @media (min-width: 1025px) and (max-width:1228px) {
        * {
            margin: 0px;
            padding: 0px;
            box-sizing: border-box;
        }

        body::-webkit-scrollbar {
            display: none;
        }

        .one {
            height: 20vh;
            width: 100%;

            display: flex;
            justify-content: space-between;
            align-items: center;
            overflow: hidden;
        }

        .two {
            height: 80vh;
            width: 100%;

        }

        .three {
            height: 5vh;
            width: 100%;
            background-color: #19388A;
        }

        .header {
            height: 100%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .purse,
        .rating {
            height: 100%;
            width: 40%;
            background-color: #19388A;
            display: flex;
            justify-content: flex-end;
            padding-right: 20px;
            align-items: center;
            border: 1px solid #19388A;
        }

        .rating {
            justify-content: flex-start;
            padding-left: 20px;
        }

        .create {
            height: 100%;
            width: 20%;
            border: 1px solid transparent;
            background-color: #19388A;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            gap: 25px;
        }

        .highest-stats {
            width: 75%;
            height: 40%;
            color: white;
            background-color: #4F91CD;
            border-radius: 5px;
            font-size: 120%;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid transparent;
        }

    }
</style>

<body>
    <div class="one">
        <div class="header">
            <div class="purse">
                <div class="highest-stats">
                    <div>Highest Purse - <span id="highestPurse"> team 1 20 cr </span></div>
                </div>
            </div>
            <div class="create">
                <button class="btn btn-primary rounded-pill" id="createTeamBtn">Create Team</button>
                <button class="btn btn-danger rounded-pill" id="resetTeamsBtn">Reset Teams</button>
            </div>
            <div class="rating">
                <div class="highest-stats">
                    <div>Highest Rating - <span id="highestRating"> 0 </span></div>
                </div>
            </div>
        </div>
    </div>
    <div class="two">
        <div class="teambox">
            <div id="inner2">
            </div>
        </div>
    </div>
    </div>
    <div class="three">
        <footer class="mt-auto text-white text-center py-3">
            <div class="foottext">&copy; IPL AUCTION GAME VERSION 1.4</div>
        </footer>
    </div>
    <script>
        let teamCount = parseInt(localStorage.getItem("teamCount")) || 0;
        const teams = JSON.parse(localStorage.getItem("teams")) || [];
        const teamNames = ["MI", "CSK", "RCB", "KKR"];

        window.onload = function () {
            teams.forEach(team => {
                createTeamFromStorage(team);
            });
            updateHighestStats();
        };

        document.getElementById("createTeamBtn").addEventListener("click", function () {
            teamCount++;
            localStorage.setItem("teamCount", teamCount);
            const teamId = `team${teamCount}`;
            const teamName = teamNames[teamCount-1];
            const team = {
                id: teamId,
                name: teamName,
                players: 0,
                purse: 50,
                rating: 0,
                playerData: []
            };
            if (teamCount > 9) { document.getElementById("createTeamBtn").disabled = true; }

            teams.push(team);
            localStorage.setItem("teams", JSON.stringify(teams));
            createTeamFromStorage(team);
        });

        document.getElementById("resetTeamsBtn").addEventListener("click", function () {
            if (confirm("Are you sure you want to reset all teams? This will clear all data.")) {
                resetTeams();
            }
        });

        function resetTeams() {
            localStorage.removeItem("teamCount");
            localStorage.removeItem("teams");
            teamCount = 0;
            teams.length = 0;
            document.getElementById("inner2").innerHTML = '';
            updateHighestStats();
        }

function createTeamFromStorage(team) {
    const teamBox = document.createElement("div");
    teamBox.id = team.name.toLowerCase(); // Set the ID for styles
    teamBox.classList.add("team");

        const existingLink = document.querySelector(`link[href="${team.name.toLowerCase()}.css"]`);
    if (!existingLink) {
        const link = document.createElement("link");
        link.rel = "stylesheet";
        link.type = "text/css";
        link.href = `${team.name.toLowerCase()}.css`;
        document.head.appendChild(link);
    }
    teamBox.innerHTML = `
       
        <div class="teamone mb-3">
            <div class="teamlogo">
                <img src="${team.name.toLowerCase()}.png">
            </div>
            <div class="teamdetail">
                <div class="teamname">
                    <h5 id="${team.id}-name-header">${team.name} &nbsp;&nbsp;&nbsp;
                        <button class="btn btn btn-sm" onclick="renameTeam('${team.id}')">
                            <i class="fa-solid fa-pen" style="color: white;"></i>
                        </button>
                        <div class="d-inline">
                            <button class="btn btn btn-sm" id="delete" onclick="deleteTeambox('${team.id}')">
                                <i class="fa-solid fa-circle-xmark" style="color: #C41E3A; font-size: 20px;"></i>
                            </button>
                        </div>
                    </h5>
                    Players - <span id="${team.id}-players">${team.players}</span> /11
                </div>
            </div>
        </div>
        <div class="teamtwo">
            <div class="summary">
                Purse: ₹<span id="${team.id}-purse">${team.purse.toFixed(2)}</span> cr | 
                Total Rating: <span id="${team.id}-rating">${team.rating.toFixed(2)}</span>
            </div>
        </div>

        <div class="input-group mb-3">
            <input type="text" class="form-control" placeholder="Player Name" id="${team.id}-name">
            <input type="number" step="0.01" class="form-control" placeholder="Price" id="${team.id}-price">
            <input type="number" step="0.01" class="form-control" placeholder="Rating" id="${team.id}-rating-input">
            <button class="btn btn-success" onclick="addPlayer('${team.id}')">+</button>
        </div>
        <div class="teamthree">
            <table class="table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Price</th>
                        <th>Rating</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody id="${team.id}-table">
                    ${team.playerData.map((player, index) => `
                        <tr draggable="true" style="background-color: ${getRowColor(team.id, index)}">
                            <td>${player.name}</td>
                            <td>${player.price.toFixed(2)}</td>
                            <td>${player.rating.toFixed(2)}</td>
                            <td>
                                <button class="btn btn-danger btn-sm" onclick="deletePlayer('${team.id}', this, ${player.price}, ${player.rating})">Delete</button>
                            </td>
                        </tr>
                    `).join('')}
                </tbody>
            </table>
        </div>
    `;
            document.getElementById("inner2").appendChild(teamBox);

            const tbody = teamBox.querySelector(`#${team.id}-table`);
            let draggedRow = null;

            tbody.addEventListener("dragstart", (event) => {
                if (event.target.tagName === "TR") {
                    draggedRow = event.target;
                    event.target.classList.add("dragging");
                }
            });

            tbody.addEventListener("dragover", (event) => {
                event.preventDefault();
                const rows = Array.from(tbody.querySelectorAll("tr"));
                const target = event.target.closest("tr");
                if (rows.includes(target) && target !== draggedRow) {
                    const rect = target.getBoundingClientRect();
                    const offset = event.clientY - rect.top;
                    if (offset < rect.height / 2) {
                        target.before(draggedRow);
                    } else {
                        target.after(draggedRow);
                    }
                }
            });

            tbody.addEventListener("dragend", (event) => {
                if (event.target.tagName === "TR") {
                    event.target.classList.remove("dragging");
                    draggedRow = null;
                    updatePlayerOrder(team.id, tbody);
                }
            });
        }

        function renameTeam(teamId) {
            const newName = prompt("Enter new team name: ");
            if (newName) {
                const team = teams.find(t => t.id === teamId);
                team.name = newName;
                document.getElementById(`${teamId}-name-header`).textContent = newName;
                localStorage.setItem("teams", JSON.stringify(teams));
            }
        }

        function addPlayer(teamId) {
            const nameInput = document.getElementById(`${teamId}-name`);
            const priceInput = document.getElementById(`${teamId}-price`);
            const ratingInput = document.getElementById(`${teamId}-rating-input`);

            const name = nameInput.value;
            const price = parseFloat(priceInput.value);
            const rating = parseFloat(ratingInput.value);

            if (!name || isNaN(price) || price < 0 || isNaN(rating)) {
                alert("Please enter valid player details");
                return;
            }

            const team = teams.find(t => t.id === teamId);

            if (team.purse < price) {
                alert("Not enough purse remaining!");
                return;
            }


            team.players++;
            team.purse -= price;
            team.rating += rating;
            team.playerData.push({ name, price, rating });

            // Update UI and localStorage
            const table = document.getElementById(`${teamId}-table`);
            const row = document.createElement("tr");
            row.draggable = true;
            row.style.backgroundColor = getRowColor(team.id, team.playerData.length - 1);
            row.innerHTML = `
        <td>${name}</td>
        <td>${price.toFixed(2)}</td>
        <td>${rating.toFixed(2)}</td>
        <td><button class="btn btn-danger btn-sm" onclick="deletePlayer('${teamId}', this, ${price}, ${rating})">Delete</button></td>
    `;
            table.appendChild(row);

            document.getElementById(`${teamId}-players`).textContent = team.players;
            document.getElementById(`${teamId}-purse`).textContent = team.purse.toFixed(2);
            document.getElementById(`${teamId}-rating`).textContent = team.rating.toFixed(2);

            nameInput.value = '';
            priceInput.value = '';
            ratingInput.value = '';

            localStorage.setItem("teams", JSON.stringify(teams));
            updateHighestStats();
        }

        function getRowColor(teamId, index) {
            return '';
        }


        function deletePlayer(teamId, button, price, rating) {
            const team = teams.find(t => t.id === teamId);

            // Find the player's index in the playerData array
            const row = button.closest("tr");
            const playerName = row.querySelector("td").textContent;
            const playerIndex = team.playerData.findIndex(player => player.name === playerName && player.price === price && player.rating === rating);

            if (playerIndex !== -1) {
                // Remove the player from the playerData array
                team.playerData.splice(playerIndex, 1);
            }

            // Update team stats
            team.players--;
            team.purse += price;
            team.rating -= rating;

            // Remove the row from the table
            row.remove();

            // Update UI
            document.getElementById(`${teamId}-players`).textContent = team.players;
            document.getElementById(`${teamId}-purse`).textContent = team.purse.toFixed(2);
            document.getElementById(`${teamId}-rating`).textContent = team.rating.toFixed(2);

            // Save updated data to local storage
            localStorage.setItem("teams", JSON.stringify(teams));

            // Update highest stats
            updateHighestStats();
        }


        function updatePlayerOrder(teamId, tbody) {
            const team = teams.find(t => t.id === teamId);
            const rows = Array.from(tbody.querySelectorAll("tr"));

            team.playerData = rows.map(row => {
                const cells = row.querySelectorAll("td");
                return {
                    name: cells[0].textContent,
                    price: parseFloat(cells[1].textContent),
                    rating: parseFloat(cells[2].textContent)
                };
            });

            localStorage.setItem("teams", JSON.stringify(teams));
        }

        function updateHighestStats() {
            let highestPurse = 0;
            let highestRating = 0;
            let highestPurseTeam = '';
            let highestRatingTeam = '';

            teams.forEach(team => {
                if (team.purse > highestPurse) {
                    highestPurse = team.purse;
                    highestPurseTeam = team.name;
                }
                if (team.rating > highestRating) {
                    highestRating = team.rating;
                    highestRatingTeam = team.name;
                }
            });

            document.getElementById("highestPurse").textContent = `${highestPurseTeam} ₹${highestPurse.toFixed(2)}`;
            document.getElementById("highestRating").textContent = `${highestRatingTeam} ${highestRating.toFixed(2)}`;
        }
function deleteTeambox(teamId) {
    const teamBox = document.getElementById(teamId.toLowerCase()); // Ensure IDs match
    if (teamBox) {
        teamBox.remove(); // Remove the team element from the DOM
        const teamIndex = teams.findIndex(t => t.id === teamId);
        if (teamIndex !== -1) {
            teams.splice(teamIndex, 1); // Remove team from the array
            localStorage.setItem("teams", JSON.stringify(teams)); // Update local storage
            updateHighestStats(); // Refresh stats
        }
    } else {
        console.error(`Team box with id "${teamId.toLowerCase()}" not found.`);
    }
}
   

    </script>
</body>

</html>
